---
about_this_resource_text: ''
course_id: 6-004-computation-structures-spring-2017
embedded_media:
- id: Video-YouTube-Stream
  media_location: m42nkRJwCKY
  parent_uid: c9b2b23c31fbc6419b9ab1723d647189
  title: Video-YouTube-Stream
  type: Video
  uid: 3c935675baf2fe7fdf0d1ab1cac0086d
- id: 3Play-3Play YouTube id-Stream
  media_location: m42nkRJwCKY
  parent_uid: c9b2b23c31fbc6419b9ab1723d647189
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: 3c6b535a2ea81661a1be5c6089c4961f
- id: Thumbnail-YouTube-JPG_1
  media_location: https://img.youtube.com/vi/m42nkRJwCKY/default.jpg
  parent_uid: c9b2b23c31fbc6419b9ab1723d647189
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: c4ae5b4421353e075a0bf11b0bd307ce
- id: m42nkRJwCKY.srt
  parent_uid: c9b2b23c31fbc6419b9ab1723d647189
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-004-computation-structures-spring-2017/c9/c9s2/c9s2v8/branches-6-19-/m42nkRJwCKY.srt
  title: 3play caption file
  type: null
  uid: 3201f57734b2f2cefa7451fe5e7d951f
- id: m42nkRJwCKY.pdf
  parent_uid: c9b2b23c31fbc6419b9ab1723d647189
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-004-computation-structures-spring-2017/c9/c9s2/c9s2v8/branches-6-19-/m42nkRJwCKY.pdf
  title: 3play pdf file
  type: null
  uid: 603067f17a5641a8fa4d666fd3b573c1
- id: Caption-3Play YouTube id-SRT
  parent_uid: c9b2b23c31fbc6419b9ab1723d647189
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: 8aecb392c2e9a0ba380d537ce3e1948d
- id: Transcript-3Play YouTube id-PDF
  parent_uid: c9b2b23c31fbc6419b9ab1723d647189
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: c62b5b31bb6212b617d9624d1dc978df
- id: Video-InternetArchive-MP4
  media_location: https://archive.org/download/MIT6.004S17/MIT6_004S17_09-02-08_300k.mp4
  parent_uid: c9b2b23c31fbc6419b9ab1723d647189
  title: Video-Internet Archive-MP4
  type: Video
  uid: c11045f3ce02a2a781d8592daa7c75f8
inline_embed_id: 77479211branches61986133566
layout: video
order_index: null
parent_uid: 55071aa433988c941a9c3496c0fdceee
related_resources_text: ''
short_url: branches-6-19-
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-004-computation-structures-spring-2017/c9/c9s2/c9s2v8/branches-6-19-
template_type: Embed
title: Branches (6:19)
transcript: <p><span m='720'>Finally,</span> <span m='1940'>let's</span> <span m='2230'>discuss</span>
  <span m='2810'>the</span> <span m='2890'>third</span> <span m='3200'>class</span>
  <span m='3560'>of</span> <span m='3660'>instructions</span> <span m='4390'>that</span>
  <span m='4580'>let</span> <span m='4770'>us</span> <span m='4930'>change</span>
  <span m='5260'>the</span> <span m='5340'>program</span> <span m='5820'>counter.</span>
  </p><p><span m='7210'>Up</span> <span m='7370'>until</span> <span m='7650'>now,</span>
  <span m='8000'>the</span> <span m='8090'>program</span> <span m='8600'>counter</span>
  <span m='8940'>has</span> <span m='9070'>simply</span> <span m='9410'>been</span>
  <span m='9610'>incremented</span> <span m='10110'>by</span> <span m='10280'>4</span>
  <span m='10500'>at</span> <span m='10790'>the</span> <span m='10970'>end</span>
  <span m='11150'>of</span> <span m='11250'>each</span> <span m='11490'>instruction,</span>
  <span m='12270'>so</span> <span m='12590'>that</span> <span m='12740'>the</span>
  <span m='12830'>next</span> <span m='13120'>instruction</span> <span m='13590'>comes</span>
  <span m='13850'>from</span> <span m='14030'>the</span> <span m='14100'>memory</span>
  <span m='14530'>location</span> <span m='15010'>that</span> <span m='15150'>immediately</span>
  <span m='15620'>follows</span> <span m='16120'>the</span> <span m='16210'>location</span>
  <span m='16720'>that</span> <span m='16850'>held</span> <span m='17090'>the</span>
  <span m='17160'>current</span> <span m='17480'>instruction,</span> </p><p><span
  m='19120'>i.e.,</span> <span m='19150'>the</span> <span m='19550'>Beta</span> <span
  m='20010'>has</span> <span m='20230'>been</span> <span m='20460'>executing</span>
  <span m='21050'>instructions</span> <span m='21650'>sequentially</span> <span m='22400'>from</span>
  <span m='22630'>memory.</span> </p><p><span m='24520'>But</span> <span m='24640'>in</span>
  <span m='24740'>many</span> <span m='25000'>programs,</span> <span m='25570'>such</span>
  <span m='25870'>as</span> <span m='26100'>in</span> <span m='26310'>factorial,</span>
  <span m='27270'>we</span> <span m='27540'>need</span> <span m='27690'>to</span>
  <span m='27760'>disrupt</span> <span m='28350'>sequential</span> <span m='28960'>execution,</span>
  <span m='29750'>either</span> <span m='30290'>to</span> <span m='30500'>loop</span>
  <span m='30700'>back</span> <span m='31280'>to</span> <span m='31570'>repeat</span>
  <span m='32060'>some</span> <span m='32250'>earlier</span> <span m='32729'>instruction,</span>
  <span m='33520'>or</span> <span m='33790'>to</span> <span m='33850'>skip</span>
  <span m='34230'>over</span> <span m='34570'>instructions</span> <span m='35180'>because</span>
  <span m='35530'>of</span> <span m='35600'>some</span> <span m='35950'>data</span>
  <span m='36340'>dependency.</span> </p><p><span m='37980'>We</span> <span m='38220'>need</span>
  <span m='38430'>a</span> <span m='38460'>way</span> <span m='38910'>to</span> <span
  m='39080'>change</span> <span m='39510'>the</span> <span m='39580'>program</span>
  <span m='40060'>counter</span> <span m='40420'>based</span> <span m='40750'>on</span>
  <span m='40860'>data</span> <span m='41100'>values</span> <span m='41520'>generated</span>
  <span m='41950'>by</span> <span m='42110'>the</span> <span m='42210'>program's</span>
  <span m='42840'>execution.</span> </p><p><span m='44540'>In</span> <span m='44610'>the</span>
  <span m='44720'>factorial</span> <span m='45270'>example,</span> <span m='45950'>as</span>
  <span m='46280'>long</span> <span m='46570'>as</span> <span m='46720'>b</span> <span
  m='46960'>is</span> <span m='47130'>not</span> <span m='47460'>equal</span> <span
  m='47790'>to</span> <span m='48030'>0,</span> <span m='48120'>we</span> <span m='48440'>need</span>
  <span m='48610'>to</span> <span m='48670'>keep</span> <span m='49000'>executing</span>
  <span m='49540'>the</span> <span m='49680'>instructions</span> <span m='50270'>that</span>
  <span m='50400'>calculate</span> <span m='51370'>a*b</span> <span m='52070'>and</span>
  <span m='52440'>decrement</span> <span m='52860'>b.</span> </p><p><span m='54180'>So</span>
  <span m='54320'>we</span> <span m='54460'>need</span> <span m='54690'>instructions</span>
  <span m='55460'>to</span> <span m='55570'>test</span> <span m='55930'>the</span>
  <span m='55990'>value</span> <span m='56370'>of</span> <span m='56490'>b</span>
  <span m='56870'>after</span> <span m='57120'>it's</span> <span m='57230'>been</span>
  <span m='57370'>decremented</span> <span m='58090'>and</span> <span m='58340'>if</span>
  <span m='58430'>it's</span> <span m='58640'>non-zero,</span> <span m='59550'>change</span>
  <span m='59980'>the</span> <span m='60070'>PC</span> <span m='60580'>to</span> <span
  m='60680'>repeat</span> <span m='61030'>the</span> <span m='61150'>loop</span> <span
  m='61470'>one</span> <span m='61600'>more</span> <span m='61830'>time.</span> </p><p><span
  m='63950'>Changing</span> <span m='64319'>the</span> <span m='64400'>PC</span> <span
  m='64920'>depending</span> <span m='65300'>on</span> <span m='65410'>some</span>
  <span m='65640'>condition</span> <span m='66230'>is</span> <span m='66420'>implemented</span>
  <span m='66930'>by</span> <span m='67130'>a</span> <span m='67200'>branch</span>
  <span m='67640'>instruction,</span> <span m='68530'>and</span> <span m='68940'>the</span>
  <span m='69060'>operation</span> <span m='69680'>is</span> <span m='69820'>referred</span>
  <span m='70240'>to</span> <span m='70540'>as</span> <span m='70760'>a</span> <span
  m='70790'>"conditional</span> <span m='71470'>branch".</span> </p><p><span m='73070'>When</span>
  <span m='73170'>the</span> <span m='73230'>branch</span> <span m='73620'>is</span>
  <span m='73730'>taken,</span> <span m='74320'>the</span> <span m='74580'>PC</span>
  <span m='75040'>is</span> <span m='75190'>changed</span> <span m='76000'>and</span>
  <span m='76410'>execution</span> <span m='76990'>is</span> <span m='77120'>restarted</span>
  <span m='77730'>at</span> <span m='77860'>the</span> <span m='77930'>new</span>
  <span m='78120'>location,</span> <span m='78800'>which</span> <span m='79130'>is</span>
  <span m='79190'>called</span> <span m='79410'>the</span> <span m='79470'>branch</span>
  <span m='79810'>target.</span> </p><p><span m='81730'>If</span> <span m='81890'>the</span>
  <span m='82000'>branch</span> <span m='82430'>is</span> <span m='82590'>not</span>
  <span m='82960'>taken,</span> <span m='83450'>the</span> <span m='83620'>PC</span>
  <span m='84000'>is</span> <span m='84120'>incremented</span> <span m='84560'>by</span>
  <span m='84740'>4</span> <span m='85070'>and</span> <span m='85460'>execution</span>
  <span m='86190'>continues</span> <span m='87350'>with</span> <span m='88030'>the</span>
  <span m='88170'>instruction</span> <span m='88800'>following</span> <span m='89260'>the</span>
  <span m='89320'>branch.</span> </p><p><span m='91490'>As</span> <span m='91630'>the</span>
  <span m='91690'>name</span> <span m='91930'>implies,</span> <span m='92570'>a</span>
  <span m='92620'>branch</span> <span m='92980'>instruction</span> <span m='93470'>represents</span>
  <span m='94030'>a</span> <span m='94070'>potential</span> <span m='94550'>fork</span>
  <span m='95060'>in</span> <span m='95300'>the</span> <span m='95430'>execution</span>
  <span m='96020'>sequence.</span> </p><p><span m='97190'>We'll</span> <span m='97340'>use</span>
  <span m='97550'>branches</span> <span m='98010'>to</span> <span m='98110'>implement</span>
  <span m='98560'>many</span> <span m='98860'>different</span> <span m='99340'>types</span>
  <span m='99690'>of</span> <span m='99770'>control</span> <span m='100200'>structures:</span>
  <span m='100920'>loops,</span> <span m='101470'>conditionals,</span> <span m='102300'>procedure</span>
  <span m='102780'>calls,</span> <span m='103270'>etc.</span> </p><p><span m='105310'>Branches</span>
  <span m='105660'>instructions</span> <span m='106310'>also</span> <span m='106680'>use</span>
  <span m='107050'>the</span> <span m='107170'>instruction</span> <span m='107710'>format</span>
  <span m='108170'>with</span> <span m='108560'>the</span> <span m='108900'>16-bit</span>
  <span m='109170'>signed</span> <span m='109540'>constant.</span> </p><p><span m='110530'>The</span>
  <span m='110630'>operation</span> <span m='111170'>of</span> <span m='111250'>the</span>
  <span m='111310'>branch</span> <span m='111690'>instructions</span> <span m='112500'>are</span>
  <span m='112690'>a</span> <span m='112720'>bit</span> <span m='112920'>complicated,</span>
  <span m='113810'>so</span> <span m='114100'>let's</span> <span m='114370'>walk</span>
  <span m='114640'>through</span> <span m='114830'>their</span> <span m='115050'>operation</span>
  <span m='115650'>step-by-step.</span> </p><p><span m='117970'>Let's</span> <span
  m='118110'>start</span> <span m='118430'>by</span> <span m='118530'>looking</span>
  <span m='118870'>at</span> <span m='118980'>the</span> <span m='119090'>operation</span>
  <span m='119650'>of</span> <span m='119810'>the</span> <span m='120280'>BEQ</span>
  <span m='120530'>instruction.</span> </p><p><span m='122480'>First</span> <span
  m='122890'>the</span> <span m='123120'>usual</span> <span m='123710'>PC</span> <span
  m='124280'>4</span> <span m='124540'>calculation</span> <span m='125290'>is</span>
  <span m='125420'>performed,</span> <span m='126170'>giving</span> <span m='126670'>us</span>
  <span m='126890'>the</span> <span m='127060'>address</span> <span m='127770'>of</span>
  <span m='128000'>the</span> <span m='128180'>instruction</span> <span m='128830'>following</span>
  <span m='129370'>the</span> <span m='129729'>BEQ.</span> </p><p><span m='131230'>This</span>
  <span m='131540'>value</span> <span m='131960'>is</span> <span m='132070'>written</span>
  <span m='132420'>to</span> <span m='132570'>the</span> <span m='132720'>"rc"</span>
  <span m='133230'>register</span> <span m='133690'>whether</span> <span m='134040'>or</span>
  <span m='134200'>not</span> <span m='134530'>the</span> <span m='134610'>branch</span>
  <span m='134970'>is</span> <span m='135060'>taken.</span> </p><p><span m='136910'>This</span>
  <span m='137120'>feature</span> <span m='137460'>of</span> <span m='137520'>branches</span>
  <span m='138020'>is</span> <span m='138280'>pretty</span> <span m='138680'>handy</span>
  <span m='139200'>and</span> <span m='139290'>we'll</span> <span m='139480'>use</span>
  <span m='139680'>it</span> <span m='139780'>to</span> <span m='139860'>implement</span>
  <span m='140250'>procedure</span> <span m='140670'>calls</span> <span m='141160'>a</span>
  <span m='141350'>couple</span> <span m='141920'>of</span> <span m='141980'>lectures</span>
  <span m='142330'>from</span> <span m='142540'>now.</span> </p><p><span m='143750'>Note</span>
  <span m='143960'>that</span> <span m='144090'>if</span> <span m='144250'>we</span>
  <span m='144370'>don't</span> <span m='144690'>need</span> <span m='144950'>to</span>
  <span m='145010'>remember</span> <span m='145460'>the</span> <span m='145570'>PC</span>
  <span m='146150'>4</span> <span m='146430'>value,</span> <span m='146910'>we</span>
  <span m='147090'>can</span> <span m='147220'>specify</span> <span m='148120'>R31</span>
  <span m='148660'>as</span> <span m='148850'>the</span> <span m='148950'>"rc"</span>
  <span m='149330'>register.</span> </p><p><span m='151240'>Next,</span> <span m='151820'>BEQ</span>
  <span m='152480'>tests</span> <span m='152980'>the</span> <span m='153070'>value</span>
  <span m='153510'>of</span> <span m='153590'>the</span> <span m='153740'>"ra"</span>
  <span m='154040'>register</span> <span m='154610'>to</span> <span m='154710'>see</span>
  <span m='154970'>if</span> <span m='155100'>it's</span> <span m='155260'>equal</span>
  <span m='155610'>to</span> <span m='156000'>0.</span> </p><p><span m='156350'>If</span>
  <span m='156870'>it</span> <span m='157450'>is</span> <span m='157640'>equal</span>
  <span m='158050'>to</span> <span m='158250'>0,</span> <span m='158350'>the</span>
  <span m='158530'>branch</span> <span m='158910'>is</span> <span m='159030'>taken</span>
  <span m='159750'>and</span> <span m='160050'>the</span> <span m='160120'>PC</span>
  <span m='160550'>is</span> <span m='160690'>incremented</span> <span m='161200'>by</span>
  <span m='161380'>the</span> <span m='161530'>amount</span> <span m='161810'>specified</span>
  <span m='162440'>in</span> <span m='162500'>the</span> <span m='162580'>constant</span>
  <span m='163160'>field</span> <span m='163470'>of</span> <span m='163570'>the</span>
  <span m='163690'>instruction.</span> </p><p><span m='165490'>Actually</span> <span
  m='165830'>the</span> <span m='165910'>constant,</span> <span m='166550'>called</span>
  <span m='166860'>an</span> <span m='167010'>offset</span> <span m='167600'>since</span>
  <span m='167840'>we're</span> <span m='167930'>using</span> <span m='168280'>it</span>
  <span m='168380'>to</span> <span m='168560'>offset</span> <span m='169280'>the</span>
  <span m='169410'>PC,</span> <span m='170340'>is</span> <span m='170740'>treated</span>
  <span m='171080'>as</span> <span m='171210'>a</span> <span m='171240'>word</span>
  <span m='171650'>offset</span> <span m='172280'>and</span> <span m='172510'>is</span>
  <span m='172630'>multiplied</span> <span m='173220'>by</span> <span m='173420'>4</span>
  <span m='173830'>to</span> <span m='174300'>convert</span> <span m='174720'>it</span>
  <span m='174920'>a</span> <span m='175040'>byte</span> <span m='175410'>offset</span>
  <span m='176080'>since</span> <span m='176480'>the</span> <span m='176560'>PC</span>
  <span m='177080'>uses</span> <span m='177420'>byte</span> <span m='177640'>addressing.</span>
  </p><p><span m='179600'>If</span> <span m='179710'>the</span> <span m='179790'>contents</span>
  <span m='180510'>of</span> <span m='180600'>the</span> <span m='180740'>"ra"</span>
  <span m='181010'>register</span> <span m='181640'>is</span> <span m='181870'>not</span>
  <span m='182220'>equal</span> <span m='182510'>to</span> <span m='182880'>0,</span>
  <span m='183210'>the</span> <span m='183570'>PC</span> <span m='183990'>is</span>
  <span m='184160'>incremented</span> <span m='184680'>by</span> <span m='185060'>4</span>
  <span m='185290'>and</span> <span m='185380'>execution</span> <span m='185940'>continues</span>
  <span m='186970'>with</span> <span m='187410'>the</span> <span m='187550'>instruction</span>
  <span m='188250'>following</span> <span m='188810'>the</span> <span m='188990'>BEQ.</span>
  </p><p><span m='189320'>Let</span> <span m='190280'>me</span> <span m='191190'>say</span>
  <span m='191390'>a</span> <span m='191430'>few</span> <span m='191610'>more</span>
  <span m='191820'>words</span> <span m='192090'>about</span> <span m='192300'>the</span>
  <span m='192420'>offset.</span> </p><p><span m='193850'>The</span> <span m='193930'>branches</span>
  <span m='194410'>are</span> <span m='194480'>using</span> <span m='194830'>what's</span>
  <span m='195020'>referred</span> <span m='195460'>to</span> <span m='195760'>as</span>
  <span m='196050'>"pc-relative</span> <span m='197180'>addressing".</span> </p><p><span
  m='198510'>That</span> <span m='198720'>means</span> <span m='199050'>the</span>
  <span m='199210'>address</span> <span m='199830'>of</span> <span m='199910'>the</span>
  <span m='199980'>branch</span> <span m='200310'>target</span> <span m='200670'>is</span>
  <span m='200750'>specified</span> <span m='201380'>relative</span> <span m='201940'>to</span>
  <span m='202060'>the</span> <span m='202240'>address</span> <span m='202760'>of</span>
  <span m='202830'>the</span> <span m='202920'>branch,</span> <span m='203540'>or,</span>
  <span m='203810'>actually,</span> <span m='204190'>relative</span> <span m='204670'>to</span>
  <span m='204800'>the</span> <span m='204960'>address</span> <span m='205420'>of</span>
  <span m='205500'>the</span> <span m='205640'>instruction</span> <span m='206150'>following</span>
  <span m='206560'>the</span> <span m='206620'>branch.</span> </p><p><span m='207830'>So</span>
  <span m='208180'>an</span> <span m='208290'>offset</span> <span m='208960'>of</span>
  <span m='209190'>0</span> <span m='209520'>would</span> <span m='209970'>refer</span>
  <span m='210500'>to</span> <span m='210760'>the</span> <span m='211010'>instruction</span>
  <span m='211660'>following</span> <span m='212110'>the</span> <span m='212180'>branch</span>
  <span m='212900'>and</span> <span m='213220'>an</span> <span m='213340'>offset</span>
  <span m='213850'>of</span> <span m='214100'>-1</span> <span m='214220'>would</span>
  <span m='214580'>refer</span> <span m='215110'>to</span> <span m='215200'>the</span>
  <span m='215280'>branch</span> <span m='215600'>itself.</span> </p><p><span m='216960'>Negative</span>
  <span m='217410'>offsets</span> <span m='217990'>are</span> <span m='218060'>called</span>
  <span m='218380'>"backwards</span> <span m='218880'>branches"</span> <span m='219670'>and</span>
  <span m='219940'>are</span> <span m='219990'>usually</span> <span m='220340'>seen</span>
  <span m='220730'>at</span> <span m='220930'>branches</span> <span m='221380'>used</span>
  <span m='221680'>at</span> <span m='221750'>the</span> <span m='221880'>end</span>
  <span m='222100'>of</span> <span m='222200'>loops,</span> <span m='223000'>where</span>
  <span m='223470'>the</span> <span m='223850'>looping</span> <span m='224360'>condition</span>
  <span m='224890'>is</span> <span m='225050'>tested</span> <span m='225620'>and</span>
  <span m='225880'>we</span> <span m='226080'>branch</span> <span m='226450'>backwards</span>
  <span m='226980'>to</span> <span m='227090'>the</span> <span m='227200'>beginning</span>
  <span m='227610'>of</span> <span m='227700'>the</span> <span m='227780'>loop</span>
  <span m='228160'>if</span> <span m='228360'>another</span> <span m='228730'>iteration</span>
  <span m='229220'>is</span> <span m='229330'>called</span> <span m='229620'>for.</span>
  </p><p><span m='231040'>Positive</span> <span m='231560'>offsets</span> <span m='232080'>are</span>
  <span m='232150'>called</span> <span m='232390'>"forward</span> <span m='232720'>branches"</span>
  <span m='233490'>and</span> <span m='233850'>are</span> <span m='233910'>usually</span>
  <span m='234330'>seen</span> <span m='234610'>in</span> <span m='234750'>code</span>
  <span m='235440'>for</span> <span m='236030'>"if</span> <span m='236280'>statements",</span>
  <span m='236950'>where</span> <span m='237240'>we</span> <span m='237350'>might</span>
  <span m='237610'>skip</span> <span m='237930'>over</span> <span m='238300'>some</span>
  <span m='238530'>part</span> <span m='238800'>of</span> <span m='238860'>the</span>
  <span m='238920'>program</span> <span m='239510'>if</span> <span m='239680'>a</span>
  <span m='239710'>condition</span> <span m='240260'>is</span> <span m='240400'>not</span>
  <span m='240650'>true.</span> </p><p><span m='242700'>We</span> <span m='242790'>can</span>
  <span m='242950'>use</span> <span m='243220'>BEQ</span> <span m='243550'>to</span>
  <span m='243770'>implement</span> <span m='244280'>a</span> <span m='244310'>so-called</span>
  <span m='244880'>unconditional</span> <span m='245550'>branch,</span> <span m='246370'>i.e.,</span>
  <span m='246820'>a</span> <span m='246920'>branch</span> <span m='247330'>that</span>
  <span m='247480'>is</span> <span m='247640'>always</span> <span m='247980'>taken.</span>
  </p><p><span m='249290'>If</span> <span m='249400'>we</span> <span m='249500'>test</span>
  <span m='249790'>R31</span> <span m='249990'>to</span> <span m='250360'>see</span>
  <span m='250720'>if</span> <span m='250820'>it's</span> <span m='251130'>0,</span>
  <span m='251370'>that's</span> <span m='251660'>always</span> <span m='251920'>true,</span>
  <span m='252230'>so</span> <span m='252440'>BEQ(R31,...)</span> <span m='253370'>would</span>
  <span m='254030'>always</span> <span m='254620'>branch</span> <span m='254990'>to</span>
  <span m='255120'>the</span> <span m='255190'>specified</span> <span m='255820'>target.</span>
  </p><p><span m='257459'>There's</span> <span m='257649'>also</span> <span m='258000'>a</span>
  <span m='258040'>BNE</span> <span m='258190'>instruction,</span> <span m='259100'>identical</span>
  <span m='259640'>to</span> <span m='259730'>BEQ</span> <span m='260170'>in</span>
  <span m='260250'>its</span> <span m='260490'>operation</span> <span m='261350'>except</span>
  <span m='261959'>the</span> <span m='262040'>sense</span> <span m='262430'>of</span>
  <span m='262490'>the</span> <span m='262560'>condition</span> <span m='263050'>is</span>
  <span m='263190'>reversed:</span> <span m='264000'>the</span> <span m='264330'>branch</span>
  <span m='264720'>is</span> <span m='264820'>taken</span> <span m='265280'>if</span>
  <span m='265400'>the</span> <span m='265530'>value</span> <span m='265930'>of</span>
  <span m='266070'>register</span> <span m='266540'>"ra"</span> <span m='266800'>is</span>
  <span m='267240'>non-zero.</span> </p><p><span m='269110'>It</span> <span m='269220'>might</span>
  <span m='269480'>seem</span> <span m='269800'>that</span> <span m='269970'>only</span>
  <span m='270230'>testing</span> <span m='270680'>for</span> <span m='270820'>zero/non-zero</span>
  <span m='271910'>doesn't</span> <span m='272250'>let</span> <span m='272410'>us</span>
  <span m='272530'>do</span> <span m='272800'>everything</span> <span m='273200'>we</span>
  <span m='273300'>might</span> <span m='273500'>want</span> <span m='273760'>to</span>
  <span m='274620'>do.</span> </p><p><span m='275440'>For</span> <span m='281250'>example,</span>
  <span m='284220'>how</span> <span m='287160'>would</span> <span m='287620'>we</span>
  <span m='287720'>branch</span> <span m='287810'>if</span> <span m='287910'>"a</span>
  <span m='288100'>b"?</span> </p><p><span m='288200'>That's</span> <span m='288290'>where</span>
  <span m='288390'>the</span> <span m='288490'>compare</span> <span m='288580'>instructions</span>
  <span m='288680'>come</span> <span m='288780'>in</span> <span m='288870'>-</span>
  <span m='288970'>they</span> <span m='289060'>do</span> <span m='289160'>more</span>
  <span m='289260'>complicated</span> <span m='289350'>comparisons,</span> <span m='289450'>producing</span>
  <span m='289550'>a</span> <span m='289640'>non-zero</span> <span m='289740'>value</span>
  <span m='289840'>if</span> <span m='289930'>the</span> <span m='290030'>comparison</span>
  <span m='290120'>is</span> <span m='290220'>true</span> <span m='290320'>and</span>
  <span m='290410'>a</span> <span m='290510'>zero</span> <span m='290610'>value</span>
  <span m='290700'>if</span> <span m='290800'>the</span> <span m='290890'>comparison</span>
  <span m='290990'>is</span> <span m='291090'>false.</span> </p><p><span m='291180'>Then</span>
  <span m='291290'>we</span> <span m='291950'>can</span> <span m='292280'>use</span>
  <span m='292610'>BEQ</span> <span m='292940'>and</span> <span m='293270'>BNE</span>
  <span m='293610'>to</span> <span m='293940'>test</span> <span m='294270'>the</span>
  <span m='294600'>result</span> <span m='294930'>of</span> <span m='295260'>the</span>
  <span m='295590'>comparison</span> <span m='295920'>and</span> <span m='296250'>branch</span>
  <span m='296580'>appropriately.</span> </p><p><span m='296920'>At</span> <span m='297250'>long</span>
  <span m='297580'>last</span> <span m='297910'>we're</span> <span m='298240'>finally</span>
  <span m='298570'>in</span> <span m='298900'>a</span> <span m='299230'>position</span>
  <span m='299560'>to</span> <span m='299890'>write</span> <span m='300230'>Beta</span>
  <span m='300560'>code</span> <span m='300890'>to</span> <span m='301220'>compute</span>
  <span m='301550'>factorial</span> <span m='301880'>using</span> <span m='302210'>the</span>
  <span m='302540'>iterative</span> <span m='302870'>algorithm</span> <span m='303200'>shown</span>
  <span m='303540'>in</span> <span m='303870'>C</span> <span m='304200'>code</span>
  <span m='304530'>on</span> <span m='304860'>the</span> <span m='305190'>left.</span>
  </p><p><span m='305520'>In</span> <span m='305850'>the</span> <span m='306180'>Beta</span>
  <span m='306510'>code,</span> <span m='306850'>the</span> <span m='307180'>loop</span>
  <span m='307510'>starts</span> <span m='307840'>at</span> <span m='308170'>the</span>
  <span m='308500'>second</span> <span m='308830'>instruction</span> <span m='309160'>and</span>
  <span m='309490'>is</span> <span m='309820'>marked</span> <span m='310160'>with</span>
  <span m='310490'>the</span> <span m='310820'>"L:"</span> <span m='311150'>label.</span>
  </p><p><span m='311480'>The</span> <span m='311810'>body</span> <span m='312140'>of</span>
  <span m='312470'>the</span> <span m='312800'>loop</span> <span m='313130'>consists</span>
  <span m='313470'>of</span> <span m='313800'>the</span> <span m='314130'>required</span>
  <span m='314460'>multiplication</span> <span m='314790'>and</span> <span m='315120'>the</span>
  <span m='315450'>decrement</span> <span m='315780'>of</span> <span m='316110'>b.</span>
  </p><p><span m='316440'>Then,</span> <span m='316780'>in</span> <span m='317110'>the</span>
  <span m='317440'>fourth</span> <span m='317770'>instruction,</span> <span m='318100'>b</span>
  <span m='318430'>is</span> <span m='318760'>tested</span> <span m='319090'>and,</span>
  <span m='319420'>if</span> <span m='319750'>it's</span> <span m='320090'>non-zero,</span>
  <span m='320420'>the</span> <span m='320750'>BNE</span> <span m='321080'>will</span>
  <span m='321410'>branch</span> <span m='321800'>back</span> <span m='322265'>to</span>
  <span m='322730'>the</span> <span m='323195'>instruction</span> <span m='323660'>with</span>
  <span m='324125'>the</span> <span m='324590'>label L.</span> <span m='325520'>Note</span>
  <span m='325985'>that</span> <span m='326450'>in</span> <span m='326915'>symbolic</span>
  <span m='327380'>notation</span> <span m='327845'>for</span> <span m='328310'>BEQ</span>
  <span m='328775'>and</span> <span m='329240'>BNE</span> <span m='329705'>instructions</span>
  <span m='330170'>we don't</span> <span m='330635'>write</span> <span m='331100'>the
  offset</span> <span m='331565'>directly</span> <span m='332030'>since</span> <span
  m='332495'>directly</span> <span m='332960'>that</span> <span m='333425'>would be</span>
  <span m='333890'>a pain</span> <span m='334355'>to calculate</span> <span m='334820'>and
  would</span> <span m='335285'>change</span> <span m='335750'>if we added</span>
  <span m='336215'>or removed</span> <span m='336680'>instructions</span> <span m='337145'>from
  the</span> <span m='337610'>loop.</span> <span m='338070'>Instead we</span> <span
  m='338530'>reference the</span> <span m='338995'>instruction to which</span> <span
  m='339460'>we want to</span> <span m='339925'>branch,</span> <span m='340390'>and
  the</span> <span m='340855'>program</span> <span m='341320'>that translates</span>
  <span m='341785'>the</span> <span m='342250'>symbolic</span> <span m='342715'>code</span>
  <span m='343180'>into the</span> <span m='343645'>binary</span> <span m='344110'>instruction</span>
  <span m='344575'>fields</span> <span m='345040'>will do</span> <span m='345505'>the
  offset</span> <span m='345970'>calculation</span> <span m='346435'>for us.</span>
  <span m='348760'>There's</span> <span m='349225'>a</span> <span m='349690'>satisfying</span>
  <span m='350155'>similarity</span> <span m='350620'>between</span> <span m='351085'>the</span>
  <span m='351550'>Beta</span> <span m='352015'>code</span> <span m='352480'>and</span>
  <span m='352945'>the</span> <span m='353410'>operations</span> <span m='353875'>specified</span>
  <span m='354340'>by</span> <span m='354805'>the</span> <span m='355270'>high-level</span>
  <span m='355770'>FSM</span> <span m='355950'>we</span> <span m='356040'>created</span>
  <span m='356310'>for</span> </p><p><span m='356760'>computing</span> <span m='357030'>factorial</span>
  <span m='357210'>in</span> <span m='357390'>the</span> <span m='357570'>simple</span>
  <span m='357750'>programmable</span> <span m='357930'>datapath</span> <span m='358110'>discussed</span>
  <span m='358290'>earlier</span> <span m='358470'>in</span> <span m='358650'>this</span>
  <span m='358830'>lecture.</span> </p><p><span m='361170'>In</span> <span m='361350'>this</span>
  <span m='361530'>example,</span> <span m='361800'>each</span> </p><p><span m='362070'>state</span>
  <span m='362250'>in</span> <span m='362430'>the</span> <span m='362610'>high-level</span>
  <span m='362700'>FSM</span> <span m='362790'>matches</span> <span m='362880'>up</span>
  <span m='362970'>nicely</span> <span m='363060'>with</span> <span m='363150'>a</span>
  <span m='363330'>particular</span> <span m='363820'>Beta</span> <span m='364310'>instruction.</span>
  </p><p><span m='364800'>We</span> <span m='365280'>wouldn't</span> <span m='365770'>expect</span>
  <span m='366260'>that</span> <span m='366750'>high</span> <span m='367240'>degree</span>
  <span m='367730'>of</span> <span m='368220'>correspondence</span> <span m='368710'>in</span>
  <span m='369190'>general,</span> <span m='369680'>but</span> <span m='370170'>since</span>
  <span m='370660'>our</span> <span m='371150'>Beta</span> <span m='371640'>datapath</span>
  <span m='372130'>and</span> <span m='372610'>the</span> <span m='373100'>example</span>
  <span m='373590'>datapath</span> <span m='374080'>were</span> <span m='374570'>very</span>
  <span m='375060'>similar,</span> <span m='375550'>the</span> <span m='376040'>states</span>
  <span m='376520'>and</span> <span m='377010'>instructions</span> <span m='377500'>match</span>
  <span m='377990'>up</span> <span m='378480'>pretty</span> <span m='378970'>well.</span>
  </p>
type: course
uid: c9b2b23c31fbc6419b9ab1723d647189

---
None